# name: test/sql/peg_parser/transformer/pragma.test
# description:
# group: [transformer]

require autocomplete

statement ok
call check_peg_transformer($$SELECT list_transform([10], x -> sum(1) + x)$$);

statement ok
call check_peg_transformer($$SELECT file_row_number, filename.substring(-8,8), b, a from delta_scan('./data/generated/evolution_column_change/delta_lake') order by a$$);

statement ok
call check_peg_transformer($$SELECT COUNT(DISTINCT s) FROM test;$$);

statement ok
call check_peg_transformer($$SELECT FIRST(i ORDER BY id), FIRST(i) FILTER (id=4) FROM tbl$$);

statement ok
call check_peg_transformer($$SELECT * FROM decimals ORDER BY d DESC$$);

statement ok
call check_peg_transformer($$SELECT * FROM final ORDER BY s_store_name1 NULLS FIRST$$);

statement ok
call check_peg_transformer($$SELECT bigint '1'$$);

statement ok
call check_peg_transformer($$SELECT foo '1'$$);

statement ok
call check_peg_transformer($$SELECT 123 as column$$);

statement ok
call check_peg_transformer($$FROM foo WHERE filename is not null$$);

statement ok
call check_peg_transformer($$select case i when 1 then 2 else 3 end;$$);

statement ok
call check_peg_transformer($$FROM foo WHERE database_name IN ('s1', 's2');$$);

statement ok
call check_peg_transformer($$SELECT ([1,2,3,4,5,6])[-9223372036854775808:5];$$);

statement ok
call check_peg_transformer($$FROM foo SELECT salary, max(salary) GROUP BY salary;$$);
