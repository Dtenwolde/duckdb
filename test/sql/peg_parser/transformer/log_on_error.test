# name: test/sql/peg_parser/transformer/use_statement.test
# description:
# group: [transformer]

require autocomplete

load __TEST_DIR__/test_peg_parser.db

statement ok
pragma enable_logging;

statement ok
call peg_parser(on_error='throw', enable_logging=true);

restart

statement ok
pragma enable_logging;

statement ok
call peg_parser(on_error='continue', enable_logging=true);

restart

statement ok
pragma enable_logging;

statement error
call peg_parser(on_error='doesnotexist', enable_logging=true);
----
Invalid Input Error: Invalid option specified for "on_error", use either "throw" or "continue"

restart

statement ok
call peg_parser(on_error='continue', enable_logging=false);

restart

statement error
call peg_parser(on_error='continue', enable_logging=doesnotexist);
----
Invalid Input Error: Failed to cast value: Could not convert string 'doesnotexist' to BOOL

restart

statement ok
pragma enable_logging;

statement ok
call peg_parser(on_error='continue', enable_logging=true);

query III
select type, log_level, message from duckdb_logs where type='PARSER';
----
PARSER	INFO	select type, log_level, message from duckdb_logs where type='PARSER';
PARSER	ERROR	select type, log_level, message from duckdb_logs where type='PARSER'; [Exception]: {"exception_type":"Not implemented","exception_message":"No transformer function found for rule 'SelectStatement'"}
PARSER	INFO	select type, log_level, message from duckdb_logs where type='PARSER';
PARSER	ERROR	select type, log_level, message from duckdb_logs where type='PARSER'; [Exception]: {"exception_type":"Not implemented","exception_message":"No transformer function found for rule 'SelectStatement'"}