# name: test/sql/peg_parser/transformer/copy.test
# description: 
# group: [transformer]

require autocomplete

statement ok
call check_peg_transformer($$COPY (FROM test) TO '__TEST_DIR__/data.csv.d' (FORMAT 'csv', COMPRESSION 'gzip', PARTITION_BY ('col0', 'col1'));$$);

statement ok
call check_peg_transformer($$COPY FROM DATABASE encrypted_v2 TO unencrypted_v_1_2_0;$$);

statement ok
call check_peg_transformer($$COPY FROM DATABASE encrypted_v2 TO unencrypted_v_1_2_0 (DATA);$$);

statement ok
call check_peg_transformer($$COPY FROM DATABASE encrypted_v2 TO unencrypted_v_1_2_0 (SCHEMA);$$);

statement ok
call check_peg_transformer($$copy 'bla' to 'bla' binary;$$);

statement ok
call check_peg_transformer($$COPY lineitem to 's3://test-bucket/tpch-sf0_01/lineitem.parquet';$$);

statement ok
call check_peg_transformer($$COPY lineitem TO lineitem.csv;$$);

statement ok
call check_peg_transformer($$COPY lineitem (l_orderkey, l_partkey) TO lineitem.csv;$$);

statement ok
call check_peg_transformer($$copy 'bla' to 'bla' (format parquet, partition_by(season,director,aired));$$);
