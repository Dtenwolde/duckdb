# name: test/sql/peg_parser/transformer/prepare.test
# description:
# group: [transformer]

require autocomplete

statement ok
call check_peg_transformer($$FROM read_avro('test/bigdata.avro') SELECT SUM(columns(*))$$);

statement ok
call check_peg_transformer($$SELECT min(COLUMNS(*)), count(COLUMNS(*)) FROM numbers;$$);

statement ok
call check_peg_transformer($$SELECT list_filter([1, 3, 1, 5], lambda x, i: x > i);$$);

statement ok
call check_peg_transformer($$SELECT nullif(2, 2);$$);

statement ok
call check_peg_transformer($$select ROW('fuzzy dice', 42, 1.99);$$);
