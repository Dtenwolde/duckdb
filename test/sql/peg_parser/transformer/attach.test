# name: test/sql/peg_parser/transformer/attach.test
# description: 
# group: [transformer]

require autocomplete

statement ok
call check_peg_transformer($$ATTACH '${DAT_PATH}/out/reader_tests/generated/all_primitive_types/delta' as dt (TYPE delta, PIN_SNAPSHOT)$$);

statement ok
call check_peg_transformer($$ATTACH 'duckdb_unittest_tempdir/8485/encrypted.duckdb' AS encrypted (ENCRYPTION_KEY 'asdf')$$);

statement ok
call check_peg_transformer($$ATTACH 'version_1_2_0.db' (STORAGE_VERSION 'v1.2.0', READONLY 1)$$);

statement ok
call check_peg_transformer($$DETACH foo$$);

statement ok
call check_peg_transformer($$DETACH IF EXISTS foo$$);

statement ok
call check_peg_transformer($$ATTACH DATABASE ':memory:' AS foo$$);

statement ok
call check_peg_transformer($$ATTACH ':memory:' AS db1 (READONLY 1)$$);

statement ok
call check_peg_transformer($$ATTACH '' AS tmp$$);

statement ok
call check_peg_transformer($$ATTACH '__TEST_DIR__/exceeds_maximum.db' (BLOCK_SIZE 2147483648)$$);

statement ok
call check_peg_transformer($$ATTACH ':memory:' as "my""db"$$);
