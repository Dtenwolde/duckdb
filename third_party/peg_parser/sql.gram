############################################################
# This file was generated by the script: generate_grammar.py
#
# DO NOT EDIT THIS FILE DIRECTLY.
# Instead, make changes to the .peg or .list files and 
# then regenerate the grammar using python generate_grammar.py.
#
# Input files used to generate this file:
#   - sql.peg
#   - keywords/reserved_keywords.list
#   - keywords/unreserved_keywords.list
############################################################

Statements <- (SingleStatement (';' SingleStatement )* ';'*)

SingleStatement <- SelectStatement / TransactionStatement / CreateStatement / InsertStatement
SelectStatement <- SimpleSelect (SetopClause SimpleSelect)*
TransactionStatement <- TransactionType
CreateStatement <- 'CREATE'i 'TABLE'i Identifier Parens(List(ColumnDefinition))
InsertStatement <- 'INSERT'i 'INTO'i Identifier (ColumnList)? (ValuesList / SelectStatement)
ColumnList <- Parens(List(Identifier))
ValuesList <- 'VALUES'i Value (',' Value)*
Value <- Parens(List(Expression))
ColumnDefinition <- Identifier TypeSpecifier
TransactionType <- 'BEGIN'i 'TRANSACTION'i / 'COMMIT'i / 'ROLLBACK'i
SetopClause <- ('UNION'i / 'EXCEPT'i / 'INTERSECT'i) 'ALL'i?

SimpleSelect <- WithClause? SelectClause FromClause? WhereClause? GroupByClause? HavingClause? OrderByClause? LimitClause?

WithStatement <- Identifier 'AS'i SubqueryReference
WithClause <- 'WITH'i List(WithStatement)
SelectClause <- 'SELECT'i ('*' / List(AliasedExpression))
ColumnAliases <- Parens(List(Identifier))

TableReference <-
    (FunctionExpression ('AS'i Identifier)?) /
    (SubqueryReference 'AS'i? Identifier ColumnAliases?) /
    (Identifier ('AS'i? Identifier)?) /


ExplicitJoin <- ('LEFT'i / 'FULL'i)? 'OUTER'i? 'JOIN'i TableReference 'ON'i Expression

FromClause <- 'FROM'i TableReference ((',' TableReference) / ExplicitJoin)*
WhereClause <- 'WHERE'i Expression
GroupByClause <- 'GROUP'i 'BY'i List(Expression)
HavingClause <- 'HAVING'i Expression

SubqueryReference <- Parens(SelectStatement)

OrderByExpression <- Expression ('DESC'i / 'ASC'i)?  ('NULLS'i 'FIRST'i / 'LAST'i)?
OrderByClause <- 'ORDER'i 'BY'i List(OrderByExpression)

LimitClause <- 'LIMIT'i NumberLiteral

PlainIdentifier <-  !ReservedKeyword <[a-z_]i[a-z0-9_]i*>  # unqoted identifier can't be top-level keyword
QuotedIdentifier <- '"' [^"]* '"'
Identifier <- QuotedIdentifier / PlainIdentifier
NumberLiteral <- < [+-]?[0-9]*([.][0-9]*)? >
StringLiteral <- '\'' [^\']* '\''
TypeSpecifier <- Identifier (Parens(List(NumberLiteral)))?

ColumnReference <- (Identifier '.')?Identifier
FunctionExpression <- Identifier Parens(List(Expression))
ParenthesisExpression <- Parens(Expression)
LiteralExpression <- StringLiteral / NumberLiteral
CastExpression <- 'CAST'i Parens(Expression 'AS'i TypeSpecifier)
ExtractExpression <- 'EXTRACT'i Parens(ColumnReference 'FROM'i Expression)
CountStarExpression <- 'COUNT'i Parens('*')
SubqueryExpression <- 'NOT'i? 'EXISTS'i? SubqueryReference
CaseExpression <- 'CASE'i ColumnReference? 'WHEN'i Expression 'THEN'i Expression ('ELSE'i Expression)? 'END'i # TODO strict
DateExpression <- 'DATE'i Expression
DistinctExpression <- 'DISTINCT'i Expression
SubstringExpression <- 'SUBSTRING'i Parens(Expression 'FROM'i NumberLiteral 'FOR'i NumberLiteral)
LiteralListExpression <- Parens(List(Expression))
FrameClause <- 'ROWS'i 'BETWEEN'i (('UNBOUNDED'i 'PRECEDING'i)) 'AND' (('CURRENT'i 'ROW'i))
WindowExpression <- Parens(('PARTITION'i 'BY'i List(Expression))? OrderByClause? FrameClause?)
IsNullExpression <- ColumnReference 'IS'i 'NOT'i? 'NULL'i # TODO

SingleExpression <-
    SubqueryExpression /
    LiteralListExpression /
    ParenthesisExpression /
    DateExpression /
    DistinctExpression /
    SubstringExpression /
    IsNullExpression /
    CaseExpression /
    CountStarExpression /
    CastExpression /
    ExtractExpression /
    WindowExpression /
    FunctionExpression /
    ColumnReference /
    LiteralExpression

ArithmeticOperator <- '+' / '-' / '*' / '/'
NotOperator <- 'NOT'i
LikeOperator <- 'NOT'i? 'LIKE'i
InOperator <- 'NOT'i? 'IN'i !'T'i # special handling to not match INTERSECT
BooleanOperator <- ('OR'i !'D'i) / 'AND'i # special handling to not match ORDER BY
ComparisonOperator <-  '=' / '<=' / '>=' / '<' / '>'
WindowOperator <- 'OVER'i
BetweenOperator <- 'BETWEEN'i

Operator <-
    NotOperator /
    ArithmeticOperator /
    ComparisonOperator /
    BooleanOperator /
    LikeOperator /
    InOperator /
    WindowOperator /
    BetweenOperator

Expression <- Operator? SingleExpression (Operator SingleExpression)*
AliasedExpression <- Expression ('AS'i? Identifier)?

# internal definitions
%whitespace <- [ \t\n\r]*
%word <- [a-zA-Z_-]
List(D) <- D (',' D)*
Parens(D) <- '(' D ')'
ReservedKeyword <-
        'UNIQUE'i /
        'FOREIGN'i /
        'DEFERRABLE'i /
        'UNION'i /
        'TRUE'i /
        'BOTH'i /
        'CAST'i /
        'ORDER'i /
        'SHOW'i /
        'CHECK'i /
        'HAVING'i /
        'ALL'i /
        'WINDOW'i /
        'PIVOT_LONGER'i /
        'WHEN'i /
        'COLUMN'i /
        'DEFAULT'i /
        'ANALYZE'i /
        'FALSE'i /
        'ONLY'i /
        'FOR'i /
        'PIVOT_WIDER'i /
        'INTERSECT'i /
        'DESC'i /
        'PRIMARY'i /
        'ANY'i /
        'LEADING'i /
        'ANALYSE'i /
        'RETURNING'i /
        'GRANT'i /
        'TO'i /
        'ASYMMETRIC'i /
        'OFFSET'i /
        'AND'i /
        'SYMMETRIC'i /
        'TABLE'i /
        'DISTINCT'i /
        'GROUP'i /
        'TRAILING'i /
        'FETCH'i /
        'UNPIVOT'i /
        'PLACING'i /
        'THEN'i /
        'NULL'i /
        'ARRAY'i /
        'AS'i /
        'NOT'i /
        'PIVOT'i /
        'WITH'i /
        'END'i /
        'SELECT'i /
        'VARIADIC'i /
        'GRAPH_TABLE'i /
        'WHERE'i /
        'EXCEPT'i /
        'ASC'i /
        'INTO'i /
        'OR'i /
        'DO'i /
        'DESCRIBE'i /
        'SUMMARIZE'i /
        'ELSE'i /
        'ON'i /
        'REFERENCES'i /
        'LATERAL'i /
        'CREATE'i /
        'CONSTRAINT'i /
        'IN'i /
        'FROM'i /
        'CASE'i /
        'INITIALLY'i /
        'LIMIT'i /
        'SOME'i /
        'COLLATE'i /
        'USING'i /
        'QUALIFY'i

UnreservedKeyword <-
        'REFRESH'i /
        'DELIMITERS'i /
        'EXECUTE'i /
        'FIRST'i /
        'TYPE'i /
        'LARGE'i /
        'DATABASE'i /
        'STORAGE'i /
        'ALSO'i /
        'EXTENSIONS'i /
        'PROCEDURE'i /
        'MILLISECONDS'i /
        'DEFERRED'i /
        'FAMILY'i /
        'SESSION'i /
        'WITHIN'i /
        'LANGUAGE'i /
        'PRIVILEGES'i /
        'PASSWORD'i /
        'CUBE'i /
        'PASSING'i /
        'OWNED'i /
        'INHERIT'i /
        'ABORT'i /
        'SCHEMAS'i /
        'LOCKED'i /
        'NEW'i /
        'INHERITS'i /
        'ADD'i /
        'ALTER'i /
        'BEFORE'i /
        'DELETE'i /
        'INCLUDE'i /
        'DISCARD'i /
        'EXTENSION'i /
        'RESET'i /
        'DATA'i /
        'TIES'i /
        'REINDEX'i /
        'HOUR'i /
        'TEMPORARY'i /
        'TRANSFORM'i /
        'START'i /
        'VIRTUAL'i /
        'AFTER'i /
        'CATALOG'i /
        'VALID'i /
        'TABLES'i /
        'LOCATION'i /
        'SQL'i /
        'NO'i /
        'LEAKPROOF'i /
        'VOLATILE'i /
        'UPDATE'i /
        'MILLISECOND'i /
        'PERCENT'i /
        'FUNCTIONS'i /
        'MICROSECOND'i /
        'SETS'i /
        'MACRO'i /
        'WHITESPACE'i /
        'OLD'i /
        'MATERIALIZED'i /
        'PARTIAL'i /
        'USER'i /
        'CHARACTERISTICS'i /
        'OTHERS'i /
        'LOCAL'i /
        'MILLENNIA'i /
        'REASSIGN'i /
        'DAY'i /
        'WEEKS'i /
        'ASSERTION'i /
        'DECADE'i /
        'UNKNOWN'i /
        'UNLOGGED'i /
        'VIEWS'i /
        'STABLE'i /
        'RESTART'i /
        'PUBLICATION'i /
        'USE'i /
        'DISABLE'i /
        'EXCLUSIVE'i /
        'CURSOR'i /
        'LOGGED'i /
        'CHAIN'i /
        'EVENT'i /
        'IGNORE'i /
        'FORCE'i /
        'REF'i /
        'NOTIFY'i /
        'SECRET'i /
        'SECOND'i /
        'LISTEN'i /
        'VARIABLE'i /
        'UNENCRYPTED'i /
        'SKIP'i /
        'CENTURY'i /
        'FILTER'i /
        'DAYS'i /
        'DEFAULTS'i /
        'CYCLE'i /
        'ABSOLUTE'i /
        'INDEXES'i /
        'INSERT'i /
        'VERSION'i /
        'HEADER'i /
        'STDIN'i /
        'ENUM'i /
        'CURRENT'i /
        'INVOKER'i /
        'ATTACH'i /
        'ORDINALITY'i /
        'EXPORT'i /
        'SCHEMA'i /
        'CONTENT'i /
        'CASCADED'i /
        'OPTIONS'i /
        'COMMITTED'i /
        'SECURITY'i /
        'EACH'i /
        'REVOKE'i /
        'MONTH'i /
        'PARTITION'i /
        'VACUUM'i /
        'OPERATOR'i /
        'MINUTE'i /
        'QUARTERS'i /
        'IMMUTABLE'i /
        'REPLICA'i /
        'CLASS'i /
        'WEEK'i /
        'SHARE'i /
        'UNTIL'i /
        'TRUNCATE'i /
        'DECLARE'i /
        'INDEX'i /
        'RANGE'i /
        'SERIALIZABLE'i /
        'AT'i /
        'SYSTEM'i /
        'SUBSCRIPTION'i /
        'IMPORT'i /
        'INSENSITIVE'i /
        'QUARTER'i /
        'PRESERVE'i /
        'GLOBAL'i /
        'ACCESS'i /
        'WRAPPER'i /
        'CSV'i /
        'RULE'i /
        'DELIMITER'i /
        'ROLLUP'i /
        'CACHE'i /
        'REFERENCING'i /
        'ENCRYPTED'i /
        'INPUT'i /
        'SNAPSHOT'i /
        'READ'i /
        'QUOTE'i /
        'MAPPING'i /
        'EXCLUDING'i /
        'CONFLICT'i /
        'COMMENTS'i /
        'REPLACE'i /
        'YEAR'i /
        'MILLENNIUM'i /
        'TYPES'i /
        'SET'i /
        'POLICY'i /
        'LABEL'i /
        'CONVERSION'i /
        'SEQUENCES'i /
        'OF'i /
        'ROLE'i /
        'DECADES'i /
        'OBJECT'i /
        'DICTIONARY'i /
        'ACTION'i /
        'ENABLE'i /
        'CASCADE'i /
        'VIEW'i /
        'ADMIN'i /
        'CALLED'i /
        'PLANS'i /
        'MODE'i /
        'TABLESPACE'i /
        'TRANSACTION'i /
        'DEALLOCATE'i /
        'MONTHS'i /
        'HANDLER'i /
        'INLINE'i /
        'AGGREGATE'i /
        'ATTRIBUTE'i /
        'CONFIGURATION'i /
        'VALUE'i /
        'YES'i /
        'NEXT'i /
        'RETURNS'i /
        'STORED'i /
        'LAST'i /
        'PROCEDURAL'i /
        'EXCLUDE'i /
        'PARALLEL'i /
        'WORK'i /
        'SCOPE'i /
        'PREPARE'i /
        'CALL'i /
        'XML'i /
        'VALIDATOR'i /
        'VARYING'i /
        'DOCUMENT'i /
        'OIDS'i /
        'TEMPLATE'i /
        'METHOD'i /
        'DROP'i /
        'BY'i /
        'JSON'i /
        'EXPORT_STATE'i /
        'NOWAIT'i /
        'CENTURIES'i /
        'RESPECT'i /
        'PRAGMA'i /
        'COMMIT'i /
        'MOVE'i /
        'UNBOUNDED'i /
        'OPTION'i /
        'STRICT'i /
        'TRIGGER'i /
        'INCLUDING'i /
        'HOLD'i /
        'SAVEPOINT'i /
        'EXPLAIN'i /
        'SEARCH'i /
        'NAME'i /
        'CLOSE'i /
        'ESCAPE'i /
        'INSTEAD'i /
        'BACKWARD'i /
        'YEARS'i /
        'TRUSTED'i /
        'COMPRESSION'i /
        'NULLS'i /
        'STATEMENT'i /
        'RESTRICT'i /
        'SERVER'i /
        'SYSID'i /
        'FOLLOWING'i /
        'OVERRIDING'i /
        'ISOLATION'i /
        'PROGRAM'i /
        'IMMEDIATE'i /
        'WRITE'i /
        'RELATIVE'i /
        'CHECKPOINT'i /
        'DOMAIN'i /
        'CONTINUE'i /
        'FUNCTION'i /
        'SCROLL'i /
        'MAXVALUE'i /
        'ENCODING'i /
        'UNLISTEN'i /
        'NOTHING'i /
        'SEQUENCE'i /
        'BEGIN'i /
        'TEMP'i /
        'SAMPLE'i /
        'COMMENT'i /
        'DOUBLE'i /
        'RECHECK'i /
        'PERSISTENT'i /
        'ROLLBACK'i /
        'INSTALL'i /
        'MATCH'i /
        'DEFINER'i /
        'INCREMENT'i /
        'LOCK'i /
        'HOURS'i /
        'OVER'i /
        'CLUSTER'i /
        'MINUTES'i /
        'IDENTITY'i /
        'STDOUT'i /
        'LOAD'i /
        'ROWS'i /
        'SECONDS'i /
        'PRIOR'i /
        'ASSIGNMENT'i /
        'ALWAYS'i /
        'MICROSECONDS'i /
        'LEVEL'i /
        'OFF'i /
        'IF'i /
        'RECURSIVE'i /
        'REPEATABLE'i /
        'EXTERNAL'i /
        'DEPENDS'i /
        'DETACH'i /
        'FORWARD'i /
        'VALIDATE'i /
        'PRECEDING'i /
        'RENAME'i /
        'STATISTICS'i /
        'UNCOMMITTED'i /
        'PARSER'i /
        'GRANTED'i /
        'MINVALUE'i /
        'KEY'i /
        'WITHOUT'i /
        'STRIP'i /
        'RELEASE'i /
        'TEXT'i /
        'IMPLICIT'i /
        'CONSTRAINTS'i /
        'PREPARED'i /
        'NAMES'i /
        'COPY'i /
        'STANDALONE'i /
        'ZONE'i /
        'CONNECTION'i /
        'OWNER'i
